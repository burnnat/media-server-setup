<VirtualHost *:80> 
  ProxyPreserveHost On
  ProxyRequests Off
  ServerName code.na.burnskids.com
  Redirect permanent / https://code.na.burnskids.com/
  ProxyPass /.well-known/acme-challenge http://localhost:8023/.well-known/acme-challenge
  ProxyPassReverse /.well-known/acme-challenge http://localhost:8023/.well-known/acme-challenge
</VirtualHost> 
<VirtualHost *:443>
  ServerName code.na.burnskids.com
  SSLEngine On
  ProxyRequests Off
  ProxyPreserveHost On
  SSLCertificateFile /etc/letsencrypt/live/code.na.burnskids.com/fullchain.pem
  SSLCertificateKeyFile /etc/letsencrypt/live/code.na.burnskids.com/privkey.pem
  ProxyPass / http://localhost:8443/
  ProxyPassReverse / http://localhost:8443/
  RewriteEngine On
  RewriteCond %{HTTP:Upgrade} =websocket [NC]
  RewriteRule /(.*) ws://localhost:8443/$1 [P,L]
  RewriteCond %{HTTP:Upgrade} !=websocket [NC]
  RewriteRule /(.*) http://localhost:8443/$1 [P,L]
</VirtualHost>
